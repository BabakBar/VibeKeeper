{
  "error_patterns": [
    {
      "id": "ios_auth_token_expired",
      "pattern": "API authorization error: token expired",
      "solution": "Implement token refresh mechanism using the refresh token in AuthViewModel",
      "context": "When making API calls through APIClient, handle 401 errors by attempting to refresh the token and retry the request",
      "files_involved": ["future: Core/API/APIClient.swift", "future: Features/Authentication/ViewModels/AuthViewModel.swift"]
    },
    {
      "id": "core_data_concurrency_violation",
      "pattern": "CoreData concurrency violation: Collection was mutated while being enumerated",
      "solution": "Use performAndWait or performBackgroundTask for CoreData operations",
      "context": "When working with CoreData fetch results, avoid mutating collections while iterating through them",
      "files_involved": ["future: Core/Storage/CoreDataStack.swift"]
    },
    {
      "id": "swiftui_view_update_cycle",
      "pattern": "Modifying state during view update, this will cause undefined behavior",
      "solution": "Use DispatchQueue.main.async when modifying state in response to view events",
      "context": "When updating state in SwiftUI views, ensure modifications are not made during the view update cycle",
      "files_involved": ["VibeKeeper/ContentView.swift", "future: Features/*/Views/*.swift"]
    },
    {
      "id": "async_image_loading",
      "pattern": "Image loading causes UI stutter",
      "solution": "Use SwiftUI's AsyncImage or implement custom lazy loading with caching",
      "context": "When loading images from URLs or files, ensure they are loaded asynchronously with appropriate caching",
      "files_involved": ["future: Features/GiftIdeas/Views/GiftIdeaDetailView.swift"]
    },
    {
      "id": "api_request_timeout",
      "pattern": "API request timed out",
      "solution": "Implement proper timeout handling and retry mechanisms in APIClient",
      "context": "For network requests, handle timeouts gracefully with user feedback and retry options",
      "files_involved": ["future: Core/API/APIClient.swift"]
    }
  ]
}